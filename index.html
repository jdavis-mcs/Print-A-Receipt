<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>72mm Receipt Editor</title>
    <!-- Load Tailwind CSS for styling the UI -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Use a common monospaced font for a receipt-like feel */
        @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;700&display=swap');

        body {
            font-family: 'IBM Plex Mono', 'Courier New', Courier, monospace;
        }

        /* --- Editor Styling --- */
        /* This is the core of the 72mm width requirement */
        #receipt-editor {
            width: 72mm;
            min-height: 100mm; /* Give some default space to type */
            border: 1px dashed #999;
            padding: 12px;
            background-color: #fff;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            border-radius: 8px;
            overflow-y: auto; /* Allows for "continuous" length */
            font-size: 10pt; /* A typical receipt font size */
            line-height: 1.5;
            color: #000;
        }

        /* Style for the contenteditable placeholder */
        #receipt-editor:empty:before {
            content: "Start typing your receipt content here...";
            color: #999;
            font-style: italic;
        }

        /* --- Fix for bullet points --- */
        /* Ensure list markers are drawn *inside* the editor's box */
        #receipt-editor ul, #receipt-editor ol {
            list-style-position: inside;
            padding-left: 1em; /* Add a little indent */
            list-style-type: disc; /* <<< ADDED: Explicitly set the dot */
        }
        /* Ensure list items display correctly */
        #receipt-editor li {
            display: list-item;
        }


        /* --- Print Styling --- */
        /* This is crucial for printing correctly on the receipt printer */
        @media print {
            /* Hide all direct children of the main wrapper */
            #main-wrapper > * {
                display: none;
            }
            
            /* NOW, un-hide the receipt container */
            #receipt-container {
                display: block !important;
                visibility: visible !important; 
            }
            
            /* Revert all children of the container to their normal display/visibility */
            /* This fixes the bug where <b>, <i>, <font> were forced to be blocks */
            #receipt-container * {
                display: revert !important;
                visibility: revert !important;
            }

            /* --- Explicit print fix for lists --- */
            /* Ensure list markers are visible when printing */
            #receipt-editor ul, #receipt-editor ol {
                list-style-position: inside !important;
                padding-left: 1em !important;
                list-style-type: disc !important; /* <<< ADDED: Explicitly set the dot for print */
            }
            #receipt-editor li {
                display: list-item !important;
            }
            
            /* And hide the script tag */
            body > script {
                display: none;
            }

            /* Reset all styling for the print media. */
            body,
            #main-wrapper {
                 /* Remove padding/margins from wrappers */
                padding: 0;
                margin: 0;
                border: none;
                box-shadow: none;
            }
            
            #receipt-container {
                margin: 0;
                padding: 0;
                display: block; /* Override the 'flex' from screen styles */
            }
            
            #receipt-editor {
                width: 100%; /* Fill the 72mm paper width */
                min-height: 0;
                border: none;
                padding: 0;
                margin: 0;
                box-shadow: none;
                border-radius: 0;
                font-size: 10pt; /* Ensure font size is consistent */
                color: #000; /* Ensure text is black for printing */
                background-color: #fff; /* Ensure background is white */
            }

            /* Remove default browser page margins */
            @page {
                margin: 0;
            }
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col items-center py-10 px-4">

    <div id="main-wrapper" class="w-full max-w-4xl"> <!-- Added id="main-wrapper" -->
        <h1 class="text-2xl font-bold text-center text-gray-800 mb-6">
            Receipt Editor (72mm)
        </h1>

        <!-- Toolbar for Rich Text Controls -->
        <div id="toolbar" class="bg-white p-3 rounded-lg shadow-md mb-4 flex flex-wrap gap-2 justify-center">
            <button onclick="formatDoc('bold')" class="font-bold px-3 py-2 bg-gray-200 hover:bg-gray-300 rounded-md transition-all">B</button>
            <button onclick="formatDoc('italic')" class="italic px-3 py-2 bg-gray-200 hover:bg-gray-300 rounded-md transition-all">I</button>
            <button onclick="formatDoc('underline')" class="underline px-3 py-2 bg-gray-200 hover:bg-gray-300 rounded-md transition-all">U</button>
            <button onclick="formatDoc('justifyLeft')" class="px-3 py-2 bg-gray-200 hover:bg-gray-300 rounded-md transition-all">L
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="21" y1="10" x2="3" y2="10"></line><line x1="21" y1="6" x2="3" y2="6"></line><line x1="21" y1="14" x2="3" y2="14"></line><line x1="21" y1="18" x2="3" y2="18"></line></svg>
            </button>
            <button onclick="formatDoc('justifyCenter')" class="px-3 py-2 bg-gray-200 hover:bg-gray-300 rounded-md transition-all">C
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="21" y1="10" x2="3" y2="10"></line><line x1="21" y1="6" x2="3" y2="6"></line><line x1="21" y1="14" x2="3" y2="14"></line><line x1="21" y1="18" x2="3" y2="18"></line></svg>
            </button>
            <button onclick="formatDoc('justifyRight')" class="px-3 py-2 bg-gray-200 hover:bg-gray-300 rounded-md transition-all">R
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="21" y1="10" x2="3" y2="10"></line><line x1="21" y1="6" x2="3" y2="6"></line><line x1="21" y1="14" x2="3" y2="14"></line><line x1="21" y1="18" x2="3" y2="18"></line></svg>
            </button>
            <button onclick="formatDoc('insertUnorderedList')" class="px-3 py-2 bg-gray-200 hover:bg-gray-300 rounded-md transition-all">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>
            </button>
            <!-- New Font Size Dropdown -->
            <select onchange="formatDoc('fontSize', this.value); this.value='';" class="font-sans px-3 py-2 bg-gray-200 hover:bg-gray-300 rounded-md transition-all appearance-none" style="padding-right: 2rem; background-position: right 0.5rem center; background-repeat: no-repeat; background-size: 1.5em 1.5em; background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20stroke%3D%22currentColor%22%20stroke-width%3D%222%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%3Cpolyline%20points%3D%226%209%2012%2015%2018%209%22%3E%3C%2Fpolyline%3E%3C%2Fsvg%3E');">
                <option value="">Size</option> <!-- Default, no change -->
				<option value="2">09pt</option> <!-- Maps to browser size 2 (approx 08/09pt) -->
                <option value="3">11pt</option> <!-- Maps to browser size 3 (approx 10/11pt) -->
                <option value="4">12pt</option> <!-- Maps to browser size 4 (approx 12/13pt) -->
                <option value="5">14pt</option> <!-- Maps to browser size 5 (approx 14pt) -->
                <option value="6">18pt</option> <!-- Maps to browser size 6 (approx 18pt) -->
                <option value="7">24pt</option> <!-- Maps to browser size 7 (approx 24pt) -->
				<option value="8">28pt</option> <!-- Maps to browser size 8 -->
				<option value="9">30pt</option> <!-- Maps to browser size 9 -->
            </select>
        </div>

        <!-- This container is necessary for the print styles to work correctly -->
        <div id="receipt-container" class="flex justify-center">
            <!-- The Editable Receipt Area -->
            <div id="receipt-editor" contenteditable="true" spellcheck="false"></div>
        </div>

        <!-- Print Button -->
        <div class="flex justify-center mt-6">
            <button onclick="printReceipt()" class="flex items-center gap-2 px-6 py-3 bg-blue-600 text-white font-bold rounded-lg shadow-md hover:bg-blue-700 transition-all">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 6 2 18 2 18 9"></polyline><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path><rect x="6" y="14" width="12" height="8"></rect></svg>
                Print Receipt
            </button>
        </div>

    </div>

    <script>
        // Function to apply formatting to the selected text
        function formatDoc(command, value = null) {
            // We use document.execCommand for simplicity, as it's
            // well-supported for these basic commands.
            document.execCommand(command, false, value);
            // Re-focus the editor after clicking a button
            document.getElementById('receipt-editor').focus();
        }

        // Function to trigger the browser's print dialog
        function printReceipt() {
            window.print();
        }
    </script>

</body>
</html>
